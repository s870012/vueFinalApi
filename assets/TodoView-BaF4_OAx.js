import{u as C,c as u,o as d,a as t,b as f,w as b,d as S,e as g,R as w,t as T,f as p,g as h,r as _,h as B,i as D,_ as O,j as F,v as I,F as L,k as P,p as R}from"./index-g1AKZnE2.js";const j={class:"todo_sm"},E={__name:"TheHeader",props:{token:{type:String},nickname:{type:String}},setup(x){const l="https://todolist-api.hexschool.io/",m=C(),c=x,v=async()=>{try{await h.post(`${l}users/sign_out`,null,{headers:{Authorization:c.token}}),document.cookie="TodoToken=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",m.push("/")}catch(n){console.log(n)}};return(n,a)=>(d(),u("header",null,[t("nav",null,[t("h1",null,[f(g(w),{to:"/"},{default:b(()=>[...a[0]||(a[0]=[S("ONLINE TODO LIST",-1)])]),_:1})]),t("ul",null,[t("li",j,[f(g(w),{to:"/todo"},{default:b(()=>[t("span",null,T(c.nickname)+" 的代辦",1)]),_:1})]),t("li",null,[t("a",{href:"#loginPage",onClick:p(v,["prevent"])},"登出")])])])]))}},U="/vueFinalApi/assets/empty%201-Cd2iwVpU.png",Y={id:"todoListPage",class:"bg-half"},G={class:"container todoListPage vhContainer"},H={class:"todoList_Content"},J={class:"inputBox"},q={key:0},K=["src"],Q={key:1,class:"todoList_list"},W={class:"todoList_tab"},X={class:"todoList_items"},Z={class:"todoList_item"},tt={class:"todoList_label"},et=["onClick","disabled","checked"],st=["onClick"],ot={class:"todoList_statistics"},at={__name:"TodoView",setup(x){const l="https://todolist-api.hexschool.io/",m=C(),c=_([]),v=_(!1);R("message",{messageText:c,isShow:v});const n=(s,e)=>{const o=new Date().getTime();c.value.push({id:o,text:s,status:e}),v.value=!0,setTimeout(()=>{const k=c.value.findIndex(M=>M.id===o);k!==-1&&c.value.splice(k,1),v.value=!1},3e3)},a=document.cookie.replace(/(?:^|.*;\s*)TodoToken\s*=\s*([^;]*).*$/i,"$1"),$=_("");B(async()=>{try{const s=await h.get(`${l}users/checkout`,{headers:{Authorization:a}});$.value=s.data.nickname,r(),n("登入成功",!0)}catch(s){console.log("錯誤",s),m.push("/")}});const i=_([]),r=async s=>{try{const e=await h.get(`${l}todos/`,{headers:{Authorization:a}});i.value=e.data.data,s==="finish"?i.value=i.value.filter(o=>o.status!==!1):s==="finishYet"&&(i.value=i.value.filter(o=>o.status!==!0))}catch(e){console.log(e)}},A=D(()=>i.value.filter(s=>s.status!==!0).length),y=_({content:""}),z=async s=>{try{await h.post(`${l}todos/`,s,{headers:{Authorization:a}}),r(),s.content="",n("新增成功",!0)}catch(e){console.log(e),n("新增失敗",!1)}},N=async s=>{try{await h.delete(`${l}todos/${s}`,{headers:{Authorization:a}}),r(),n("刪除成功",!0)}catch(e){console.log(e),n("刪除失敗",!1)}},V=async s=>{try{const e=await h.patch(`${l}todos/${s.id}/toggle`,null,{headers:{Authorization:a}});s.status=e.data.status,n("代辦事項完成",!0)}catch(e){console.log(e)}};return(s,e)=>(d(),u(L,null,[f(O),t("div",Y,[f(E,{token:g(a),nickname:$.value},null,8,["token","nickname"]),t("div",G,[t("div",H,[t("div",J,[F(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=o=>y.value.content=o)},null,512),[[I,y.value.content]]),t("a",{href:"#",onClick:e[1]||(e[1]=p(o=>z(y.value),["prevent"]))},[...e[5]||(e[5]=[t("i",{class:"bi bi-plus-lg"},null,-1)])])]),i.value.length<1?(d(),u("div",q,[e[6]||(e[6]=t("p",{class:"text-center fs-5 mt-5 mb-4"},"目前無代辦事項",-1)),t("img",{src:g(U),alt:"",class:"w-auto d-block mx-auto object-fit-cover"},null,8,K)])):(d(),u("div",Q,[t("ul",W,[t("li",null,[t("a",{href:"#",class:"active",onClick:e[2]||(e[2]=p(o=>r("all"),["prevent"]))},"全部")]),t("li",null,[t("a",{href:"#",class:"active",onClick:e[3]||(e[3]=p(o=>r("finishYet"),["prevent"]))},"待完成")]),t("li",null,[t("a",{href:"#",class:"active",onClick:e[4]||(e[4]=p(o=>r("finish"),["prevent"]))},"已完成")])]),t("div",X,[t("ul",Z,[(d(!0),u(L,null,P(i.value,o=>(d(),u("li",{key:o.id},[t("label",tt,[t("input",{class:"todoList_input",type:"checkbox",onClick:k=>V(o),disabled:o.status===!0,checked:o.status===!0},null,8,et),t("span",null,T(o.content),1)]),t("button",{type:"button",class:"btn",onClick:p(k=>N(o.id),["prevent"])},[...e[7]||(e[7]=[t("i",{class:"bi bi-x-lg"},null,-1)])],8,st)]))),128))]),t("div",ot,[t("p",null,T(A.value)+" 個待完成項目",1)])])]))])])])],64))}};export{at as default};
