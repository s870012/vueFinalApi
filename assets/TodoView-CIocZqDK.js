import{u as N,c,o as r,a as e,b as g,w as C,d as P,e as T,R as z,t as m,f as y,g as h,r as u,h as R,i as A,M as j,T as E,j as U,v as G,F as x,k as M,n as H,p as J}from"./index-CgQgVarn.js";const q={class:"todo_sm"},K={__name:"TheHeader",props:{token:{type:String},nickname:{type:String}},setup($){const l="https://todolist-api.hexschool.io/",L=N(),i=$,p=async()=>{try{await h.post(`${l}users/sign_out`,null,{headers:{Authorization:i.token}}),document.cookie="TodoToken=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",L.push("/")}catch(a){console.log(a)}};return(a,n)=>(r(),c("header",null,[e("nav",null,[e("h1",null,[g(T(z),{to:"/"},{default:C(()=>[...n[0]||(n[0]=[P("ONLINE TODO LIST",-1)])]),_:1})]),e("ul",null,[e("li",q,[g(T(z),{to:"/todo"},{default:C(()=>[e("span",null,m(i.nickname)+" 的代辦",1)]),_:1})]),e("li",null,[e("a",{href:"#loginPage",onClick:y(p,["prevent"])},"登出")])])])]))}},Q="/vueFinalApi/assets/empty%201-Cd2iwVpU.png",W={id:"todoListPage",class:"bg-half"},X={class:"container todoListPage vhContainer"},Y={class:"todoList_Content"},Z={class:"inputBox"},ee={key:0},te=["src"],se={key:1,class:"todoList_list"},oe={class:"todoList_tab"},ae=["onClick"],ne={class:"todoList_items"},le={class:"todoList_item"},ie={class:"todoList_label"},ue=["onClick","checked"],ce=["onClick"],re={class:"todoList_statistics"},ve={__name:"TodoView",setup($){const l="https://todolist-api.hexschool.io/",L=N(),i=u([]),p=u(!1),a=u(!1);J("message",{messageText:i,isShow:p});const n=(t,s)=>{const o=new Date().getTime();i.value.push({id:o,text:t,status:s}),p.value=!0,setTimeout(()=>{const _=i.value.findIndex(I=>I.id===o);_!==-1&&i.value.splice(_,1),p.value=!1},3e3)},d=document.cookie.replace(/(?:^|.*;\s*)TodoToken\s*=\s*([^;]*).*$/i,"$1"),w=u("");R(async()=>{a.value=!0;try{const t=await h.get(`${l}users/checkout`,{headers:{Authorization:d}});w.value=t.data.nickname,f(),n("登入成功",!0)}catch(t){console.log("錯誤",t),L.push("/")}finally{a.value=!1}});const v=u([]),f=async()=>{try{const t=await h.get(`${l}todos/`,{headers:{Authorization:d}});v.value=t.data.data}catch(t){console.log(t)}},V=[{label:"全部",value:"all"},{label:"待完成",value:"pending"},{label:"已完成",value:"finish"}],k=u("all"),S=A(()=>k.value==="pending"?v.value.filter(t=>t.status===!1):k.value==="finish"?v.value.filter(t=>t.status===!0):v.value),B=A(()=>v.value.filter(t=>t.status!==!0).length),b=u({content:""}),D=async t=>{a.value=!0;try{await h.post(`${l}todos/`,t,{headers:{Authorization:d}}),f(),t.content="",n("新增成功",!0)}catch(s){console.log(s),n("新增失敗",!1)}finally{a.value=!1}},O=async t=>{a.value=!0;try{await h.delete(`${l}todos/${t}`,{headers:{Authorization:d}}),f(),n("刪除成功",!0)}catch(s){console.log(s),n("刪除失敗",!1)}finally{a.value=!1}},F=async t=>{a.value=!0;try{const s=await h.patch(`${l}todos/${t.id}/toggle`,null,{headers:{Authorization:d}});t.status=s.data.status,f(),n("狀態更新",!0)}catch(s){console.log(s)}finally{a.value=!1}};return(t,s)=>(r(),c(x,null,[g(j),g(E,{isLoading:a.value},null,8,["isLoading"]),e("div",W,[g(K,{token:T(d),nickname:w.value},null,8,["token","nickname"]),e("div",X,[e("div",Y,[e("div",Z,[U(e("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":s[0]||(s[0]=o=>b.value.content=o)},null,512),[[G,b.value.content]]),e("a",{href:"#",onClick:s[1]||(s[1]=y(o=>D(b.value),["prevent"]))},[...s[2]||(s[2]=[e("i",{class:"bi bi-plus-lg"},null,-1)])])]),v.value.length===0?(r(),c("div",ee,[s[3]||(s[3]=e("p",{class:"text-center fs-5 mt-5 mb-4"},"目前無代辦事項",-1)),e("img",{src:T(Q),alt:"",class:"w-auto d-block mx-auto object-fit-cover"},null,8,te)])):(r(),c("div",se,[e("ul",oe,[(r(),c(x,null,M(V,o=>e("li",{key:o},[e("a",{href:"#",class:H(k.value===o.value?"active":""),onClick:y(_=>k.value=o.value,["prevent"])},m(o.label),11,ae)])),64))]),e("div",ne,[e("ul",le,[(r(!0),c(x,null,M(S.value,o=>(r(),c("li",{key:o.id},[e("label",ie,[e("input",{class:"todoList_input",type:"checkbox",onClick:_=>F(o),checked:o.status===!0},null,8,ue),e("span",null,m(o.content),1)]),e("button",{type:"button",class:"btn",onClick:y(_=>O(o.id),["prevent"])},[...s[4]||(s[4]=[e("i",{class:"bi bi-x-lg"},null,-1)])],8,ce)]))),128))]),e("div",re,[e("p",null,m(B.value)+" 個待完成項目",1)])])]))])])])],64))}};export{ve as default};
